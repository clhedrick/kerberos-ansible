# sssd.conf distributed by ansible. Based on
# centos 7 autogenerated file with lots of modifications
# It's built from a template, so there are differences 
# depending upon Linux version and cluster or system
[domain/cs.rutgers.edu]

#main domain
ipa_domain = cs.rutgers.edu

#caching and offline
cache_credentials = True
krb5_store_password_if_offline = True

#providers
id_provider = ipa
auth_provider = ipa
chpass_provider = ipa
selinux_provider=none

#hostname
ipa_hostname = {{ ansible_fqdn }}


{% if grouplist is defined %}
access_provider = simple

simple_allow_groups = {{ grouplist }}

{% elif groupsuffix is defined %}
#set cluster using this filter
access_provider = ldap

ldap_dns_service_name = ldaps
ldap_access_filter = (&(memberOf=cn=login-{{ groupsuffix }},cn=groups,cn=accounts,dc=cs,dc=rutgers,dc=edu)(!(memberOf=cn=disabled-{{ groupsuffix }},cn=groups,cn=accounts,dc=cs,dc=rutgers,dc=edu)))

# By default, ldap using GSSAPI uses host credentials from /etc/krb5.keytab
ldap_sasl_mech=GSSAPI
ldap_tls_cacert = /etc/krb5.i2chain.pem

{% else %}
# access only via /etc/passwd. Pam will allow this using localuser, so we deny
access_provider = deny

{% endif %}
{% if homedir is defined %}
# home directories
override_homedir = {{ homedir }}/%u

{% endif %}
# timeout cache so new users show up
entry_cache_timeout=300

#ipa_server = _srv_, krb1.cs.rutgers.edu, krb2.cs.rutgers.edu
dns_discovery_domain = cs.rutgers.edu

#
[sssd]
# possible nss, pam , sudo , autofs , ssh , pac
services = nss, pam, ssh
domains = cs.rutgers.edu
config_file_version = 2

[nss]
#homedir_substring = /home

[pam]

[sudo]

[autofs]

[ssh]

[pac]

[ifp]

